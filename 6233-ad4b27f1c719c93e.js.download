"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6233],{23843:(e,t,s)=>{s.d(t,{$W:()=>r,Jn:()=>l});let a=(()=>{let e="production";if(e){if("local"===e)return console.log("Using explicitly set LOCAL environment mode"),"local";else if("staging"===e)return console.log("Using explicitly set STAGING environment mode"),"staging";else if("production"===e)return console.log("Using explicitly set PRODUCTION environment mode"),"production"}return console.log("Defaulting to PRODUCTION environment mode"),"production"})(),r={ENV_MODE:a,IS_LOCAL:"local"===a,SUBSCRIPTION_TIERS:"staging"===a?{FREE:{priceId:"price_1RIGvuG6l1KZGqIrw14abxeL",name:"Free"},TIER_2_20:{priceId:"price_1RIGvuG6l1KZGqIrCRu0E4Gi",name:"2h/$20"},TIER_6_50:{priceId:"price_1RIGvuG6l1KZGqIrvjlz5p5V",name:"6h/$50"},TIER_12_100:{priceId:"price_1RIGvuG6l1KZGqIrT6UfgblC",name:"12h/$100"},TIER_25_200:{priceId:"price_1RIGvuG6l1KZGqIrOVLKlOMj",name:"25h/$200"},TIER_50_400:{priceId:"price_1RIKNgG6l1KZGqIrvsat5PW7",name:"50h/$400"},TIER_125_800:{priceId:"price_1RIKNrG6l1KZGqIrjKT0yGvI",name:"125h/$800"},TIER_200_1000:{priceId:"price_1RIKQ2G6l1KZGqIrum9n8SI7",name:"200h/$1000"}}:{FREE:{priceId:"price_1RILb4G6l1KZGqIrK4QLrx9i",name:"Free"},TIER_2_20:{priceId:"price_1RILb4G6l1KZGqIrhomjgDnO",name:"2h/$20"},TIER_6_50:{priceId:"price_1RILb4G6l1KZGqIr5q0sybWn",name:"6h/$50"},TIER_12_100:{priceId:"price_1RILb4G6l1KZGqIr5Y20ZLHm",name:"12h/$100"},TIER_25_200:{priceId:"price_1RILb4G6l1KZGqIrGAD8rNjb",name:"25h/$200"},TIER_50_400:{priceId:"price_1RILb4G6l1KZGqIruNBUMTF1",name:"50h/$400"},TIER_125_800:{priceId:"price_1RILb3G6l1KZGqIrbJA766tN",name:"125h/$800"},TIER_200_1000:{priceId:"price_1RILb3G6l1KZGqIrmauYPOiN",name:"200h/$1000"}}},l=()=>r.IS_LOCAL},61446:(e,t,s)=>{s.d(t,{i:()=>o});var a=s(95155),r=s(1243),l=s(54416),i=s(30285),n=s(35695);function o(e){let{message:t,currentUsage:s,limit:o,accountId:c,onDismiss:d,isOpen:u}=e,m=(0,n.useRouter)();return u?(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-[9999]",children:(0,a.jsx)("div",{className:"bg-destructive/15 backdrop-blur-sm border border-destructive/30 rounded-lg p-5 shadow-lg max-w-md",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 bg-destructive/20 p-2 rounded-full",children:(0,a.jsx)(r.A,{className:"h-5 w-5 text-destructive"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-destructive",children:"Usage Limit Reached"}),(0,a.jsx)(i.$,{variant:"ghost",size:"icon",onClick:d,className:"h-6 w-6 p-0 text-muted-foreground hover:text-foreground",children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:t}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",onClick:d,className:"text-xs",children:"Dismiss"}),(0,a.jsx)(i.$,{size:"sm",onClick:()=>m.push("/settings/billing?accountId=".concat(c)),className:"text-xs bg-destructive hover:bg-destructive/90",children:"Upgrade Plan"})]})]})]})})}):null}},66695:(e,t,s)=>{s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>i});var a=s(95155);s(12115);var r=s(59434);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}},99630:(e,t,s)=>{s.d(t,{V:()=>J});var a,r,l,i=s(95155),n=s(12115),o=s(63527),c=s(51154),d=s(66695),u=s(30285),m=s(50492),p=s(56671),x=s(52643),h=s(46102);let f=(e,t,s)=>{let a=e.filter(e=>!(e.size>0x3200000)||(p.oR.error("File size exceeds 50MB limit: ".concat(e.name)),!1));t(e=>[...e,...a]);let r=a.map(e=>({name:e.name,path:"/workspace/".concat(e.name),size:e.size,type:e.type||"application/octet-stream",localUrl:URL.createObjectURL(e)}));s(e=>[...e,...r]),a.forEach(e=>{p.oR.success("File attached: ".concat(e.name))})},g=async(e,t,s,a)=>{try{a(!0);let r=[];for(let s of e){if(s.size>0x3200000){p.oR.error("File size exceeds 50MB limit: ".concat(s.name));continue}let e=new FormData;e.append("file",s);let a="/workspace/".concat(s.name);e.append("path",a);let l=(0,x.U)(),{data:{session:i}}=await l.auth.getSession();if(!(null==i?void 0:i.access_token))throw Error("No access token available");let n=await fetch("".concat("https://api.suna.so/api","/sandboxes/").concat(t,"/files"),{method:"POST",headers:{Authorization:"Bearer ".concat(i.access_token)},body:e});if(!n.ok)throw Error("Upload failed: ".concat(n.statusText));r.push({name:s.name,path:a,size:s.size,type:s.type||"application/octet-stream"}),p.oR.success("File uploaded: ".concat(s.name))}s(e=>[...e,...r])}catch(e){console.error("File upload failed:",e),p.oR.error("string"==typeof e?e:e instanceof Error?e.message:"Failed to upload file")}finally{a(!1)}},v=async(e,t,s,a,r)=>{t?await g(e,t,a,r):f(e,s,a)},b=(0,n.forwardRef)((e,t)=>{let{loading:s,disabled:a,isAgentRunning:r,isUploading:l,sandboxId:o,setPendingFiles:d,setUploadedFiles:p,setIsUploading:x}=e;(0,n.useEffect)(()=>()=>{p(e=>(e.forEach(e=>{e.localUrl&&URL.revokeObjectURL(e.localUrl)}),e))},[]);let f=async e=>{e.target.files&&0!==e.target.files.length&&(v(Array.from(e.target.files),o,d,p,x),e.target.value="")};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.Bc,{children:(0,i.jsxs)(h.m_,{children:[(0,i.jsx)(h.k$,{asChild:!0,children:(0,i.jsxs)(u.$,{type:"button",onClick:()=>{t&&"current"in t&&t.current&&t.current.click()},variant:"ghost",size:"default",className:"h-7 rounded-md text-muted-foreground",disabled:s||a&&!r||l,children:[l?(0,i.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(m.A,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"text-sm",children:"Attachments"})]})}),(0,i.jsx)(h.ZI,{side:"top",children:(0,i.jsx)("p",{children:"Attach files"})})]})}),(0,i.jsx)("input",{type:"file",ref:t,className:"hidden",onChange:f,multiple:!0})]})});b.displayName="FileUploadHandler";var j=s(59434);function I(e){let{className:t,...s}=e;return(0,i.jsx)("textarea",{"data-slot":"textarea",className:(0,j.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var w=s(18979),y=s(39881),N=s(44838),R=s(66474),_=s(71539),E=s(32919),S=s(5196),G=s(54165),k=s(59964);let L=e=>{let{cancelText:t="Maybe Later",children:s,open:a=!1,ctaText:r="Upgrade Now",description:l="This feature requires an upgrade to access.",onDialogClose:o,onUpgradeClick:c,upgradeUrl:d="/settings/billing",title:m="Upgrade Required"}=e,p=(0,n.useCallback)(()=>{c?c():window.location.href=d},[c,d]),x=(0,n.useCallback)(()=>{o&&o()},[o]);return(0,n.useEffect)(()=>()=>{document.body.classList.remove("overflow-hidden"),document.body.style.pointerEvents="auto",document.querySelectorAll("[data-backdrop]").forEach(e=>e.remove())},[]),(0,n.useEffect)(()=>{a||(document.body.classList.remove("overflow-hidden"),document.body.style.pointerEvents="auto",document.querySelectorAll('[role="dialog"]').forEach(e=>{e.closest('[open="true"]')||e.remove()}))},[a]),(0,i.jsxs)(i.Fragment,{children:[s,(0,i.jsx)(G.lG,{open:a,onOpenChange:e=>{e||(document.body.style.pointerEvents="auto",document.body.classList.remove("overflow-hidden"),setTimeout(()=>{o&&o()},0))},children:(0,i.jsxs)(G.Cf,{className:"sm:max-w-md",onEscapeKeyDown:()=>{x(),document.body.style.pointerEvents="auto"},children:[(0,i.jsxs)(G.c7,{children:[(0,i.jsx)(G.L3,{children:m}),(0,i.jsx)(G.rr,{children:l})]}),(0,i.jsx)("div",{className:"py-6",children:(0,i.jsxs)("div",{className:"flex flex-col items-center text-center space-y-4",children:[(0,i.jsx)("div",{className:"rounded-full bg-primary/10 p-3",children:(0,i.jsx)(k.A,{className:"h-6 w-6 text-primary"})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h3",{className:"text-lg font-medium",children:"Upgrade to unlock"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Get access to premium models and features"})]})]})}),(0,i.jsxs)(G.Es,{className:"flex items-center gap-2",children:[(0,i.jsx)(u.$,{onClick:()=>{document.body.style.pointerEvents="auto",document.body.classList.remove("overflow-hidden"),x()},variant:"outline",children:t}),(0,i.jsxs)(u.$,{onClick:()=>{document.body.style.pointerEvents="auto",document.body.classList.remove("overflow-hidden"),p()},variant:"default",children:[(0,i.jsx)(k.A,{className:"h-4 w-4"}),r]})]})]})})]})},U=e=>{var t,s;let{selectedModel:a,onModelChange:r,modelOptions:l,canAccessModel:o}=e,[c,d]=(0,n.useState)(!1),[m,p]=(0,n.useState)(null),x=(null==(t=l.find(e=>e.id===a))?void 0:t.label)||"Select model",f=e=>{o(e)?r(e):(p(e),d(!0))};return(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)(N.rI,{children:[(0,i.jsx)(N.ty,{asChild:!0,children:(0,i.jsx)(u.$,{variant:"ghost",size:"default",className:"h-8 rounded-md text-muted-foreground shadow-none border-none focus:ring-0 px-3",children:(0,i.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium",children:[(0,i.jsx)("span",{children:x}),(0,i.jsx)(R.A,{className:"h-3 w-3 opacity-50 ml-1"})]})})}),(0,i.jsx)(N.SQ,{align:"end",className:"w-64 p-1",children:l.map(e=>{let t=o(e.id);return(0,i.jsx)(h.Bc,{children:(0,i.jsxs)(h.m_,{children:[(0,i.jsx)(h.k$,{asChild:!0,children:(0,i.jsx)(N._2,{className:"text-sm py-3 px-3 flex items-start cursor-pointer rounded-md",onClick:()=>f(e.id),children:(0,i.jsxs)("div",{className:"flex flex-col w-full",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["sonnet-3.7"===e.id&&(0,i.jsx)(_.A,{className:"h-4 w-4 text-yellow-500"}),(0,i.jsx)("span",{className:"font-medium",children:e.label}),!t&&(0,i.jsx)(E.A,{className:"h-3 w-3 ml-1 text-gray-400"})]}),a===e.id&&(0,i.jsx)(S.A,{className:"h-4 w-4 text-blue-500"})]}),(0,i.jsx)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:e.description})]})})}),!t&&(0,i.jsx)(h.ZI,{side:"left",className:"text-xs",children:(0,i.jsx)("p",{children:"Requires subscription to access"})})]})},e.id)})})]}),c&&(0,i.jsx)(L,{open:!0,onDialogClose:()=>{d(!1),p(null)},title:"Premium Model",description:m?"Subscribe to access ".concat(null==(s=l.find(e=>e.id===m))?void 0:s.label):"Subscribe to access premium models",ctaText:"Subscribe Now",cancelText:"Maybe Later"})]})},A=(0,n.forwardRef)((e,t)=>{let{value:s,onChange:a,onSubmit:r,placeholder:l,loading:o,disabled:d,isAgentRunning:m,onStopAgent:p,isDraggingOver:x,uploadedFiles:h,fileInputRef:f,isUploading:g,sandboxId:v,setPendingFiles:N,setUploadedFiles:R,setIsUploading:_,hideAttachments:E=!1,selectedModel:S,onModelChange:G,modelOptions:k,subscriptionStatus:L,canAccessModel:A}=e;return(0,n.useEffect)(()=>{if(!t.current)return;let e=()=>{t.current.style.height="auto";let e=Math.min(Math.max(t.current.scrollHeight,24),200);t.current.style.height="".concat(e,"px")};return e(),e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[s,t]),(0,i.jsxs)("div",{className:"flex flex-col w-full h-auto gap-4 justify-between",children:[(0,i.jsx)("div",{className:"flex gap-2 items-center px-2",children:(0,i.jsx)(I,{ref:t,value:s,onChange:a,onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),(s.trim()||h.length>0)&&!o&&(!d||m)&&r(e))},placeholder:l,className:(0,j.cn)("w-full bg-transparent dark:bg-transparent border-none shadow-none focus-visible:ring-0 px-2 py-1 text-base min-h-[40px] max-h-[200px] overflow-y-auto resize-none",x?"opacity-40":""),disabled:o||d&&!m,rows:2})}),(0,i.jsxs)("div",{className:"flex items-center justify-between mt-1 ml-3 mb-1 pr-2",children:[(0,i.jsx)("div",{className:"flex items-center gap-3",children:!E&&(0,i.jsx)(b,{ref:f,loading:o,disabled:d,isAgentRunning:m,isUploading:g,sandboxId:v,setPendingFiles:N,setUploadedFiles:R,setIsUploading:_})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(U,{selectedModel:S,onModelChange:G,modelOptions:k,canAccessModel:A}),(0,i.jsx)(u.$,{type:"submit",onClick:m&&p?p:r,size:"sm",className:(0,j.cn)("w-7 h-7 flex-shrink-0 self-end",m?"bg-red-500 hover:bg-red-600":"",(s.trim()||0!==h.length||m)&&!o&&(!d||m)?"":"opacity-50"),disabled:!s.trim()&&0===h.length&&!m||o||d&&!m,children:o?(0,i.jsx)(c.A,{className:"h-4 w-4 animate-spin"}):m?(0,i.jsx)(w.A,{className:"h-4 w-4"}):(0,i.jsx)(y.A,{className:"h-4 w-4"})})]})]})]})});A.displayName="MessageInput";var C=s(86618),T=s(32960),q=s(5041),F=s(25731);let K={all:["subscription"],details:()=>[...K.all,"details"]},$=(a=K.details(),r=F.uV,l={staleTime:3e5,refetchOnWindowFocus:!0},e=>(0,T.I)({queryKey:a,queryFn:r,...l,...e}));var M=s(23843);let O="suna-preferred-model",Z="deepseek",z="sonnet-3.7",D=[{id:"deepseek",label:"Free",requiresSubscription:!1,description:"Limited capabilities. Upgrade for full performance."},{id:"sonnet-3.7",label:"Standard",requiresSubscription:!0,description:"Excellent for complex tasks and nuanced conversations"}],P=(e,t)=>!!(0,M.Jn)()||"active"===e||!t,B=()=>{let[e,t]=(0,n.useState)(Z),{data:s}=$(),a=(null==s?void 0:s.status)==="active"?"active":"no_subscription";return(0,n.useEffect)(()=>{try{let e=localStorage.getItem(O);if((0,M.Jn)()){if(e&&D.find(t=>t.id===e))t(e);else{t(z);try{localStorage.setItem(O,z)}catch(e){console.warn("Failed to save model preference to localStorage:",e)}}return}if("active"===a){if(e){let s=D.find(t=>t.id===e);if(s&&P(a,s.requiresSubscription))return void t(e)}t(z);try{localStorage.setItem(O,z)}catch(e){console.warn("Failed to save model preference to localStorage:",e)}}else if(e){let s=D.find(t=>t.id===e);s&&P(a,s.requiresSubscription)?t(e):(localStorage.removeItem(O),t(Z))}else t(Z)}catch(e){console.warn("Failed to load preferences from localStorage:",e)}},[a]),{selectedModel:e,setSelectedModel:e=>{let s=D.find(t=>t.id===e);if(s&&((0,M.Jn)()||P(a,s.requiresSubscription))){t(e);try{localStorage.setItem(O,e)}catch(e){console.warn("Failed to save model preference to localStorage:",e)}}},subscriptionStatus:a,availableModels:(0,M.Jn)()?D:D.filter(e=>P(a,e.requiresSubscription)),allModels:D,canAccessModel:e=>{if((0,M.Jn)())return!0;let t=D.find(t=>t.id===e);return!!t&&P(a,t.requiresSubscription)},isSubscriptionRequired:e=>{var t;return(null==(t=D.find(t=>t.id===e))?void 0:t.requiresSubscription)||!1}}},J=(0,n.forwardRef)((e,t)=>{let{onSubmit:s,placeholder:a="Describe what you need help with...",loading:r=!1,disabled:l=!1,isAgentRunning:u=!1,onStopAgent:m,autoFocus:p=!0,value:x,onChange:h,onFileBrowse:f,sandboxId:g,hideAttachments:b=!1}=e,j=void 0!==x&&void 0!==h,[I,w]=(0,n.useState)(""),y=j?x:I,[N,R]=(0,n.useState)([]),[_,E]=(0,n.useState)([]),[S,G]=(0,n.useState)(!1),[k,L]=(0,n.useState)(!1),{selectedModel:U,setSelectedModel:T,subscriptionStatus:q,allModels:F,canAccessModel:K}=B(),$=(0,n.useRef)(null),M=(0,n.useRef)(null);(0,n.useImperativeHandle)(t,()=>({getPendingFiles:()=>_,clearPendingFiles:()=>E([])})),(0,n.useEffect)(()=>{p&&$.current&&$.current.focus()},[p]);let O=async e=>{if(e.preventDefault(),!y.trim()&&0===N.length||r||l&&!u)return;if(u&&m)return void m();let t=y;if(N.length>0){let e=N.map(e=>"[Uploaded File: ".concat(e.path,"]")).join("\n");t=t?"".concat(t,"\n\n").concat(e):e}let a=U,i=!1;U.endsWith("-thinking")&&(a=U.replace(/-thinking$/,""),i=!0),s(t,{model_name:a,enable_thinking:i}),j||w(""),R([])};return(0,i.jsxs)("div",{className:"mx-auto w-full max-w-4xl px-4",children:[(0,i.jsx)(d.Zp,{className:"shadow-none w-full max-w-4xl mx-auto bg-transparent border-none rounded-xl overflow-hidden",onDragOver:e=>{e.preventDefault(),e.stopPropagation(),L(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),L(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),L(!1),M.current&&e.dataTransfer.files.length>0&&v(Array.from(e.dataTransfer.files),g,E,R,G)},children:(0,i.jsx)("div",{className:"w-full text-sm flex flex-col justify-between items-start rounded-lg",children:(0,i.jsxs)(d.Wu,{className:"w-full p-1.5 pb-2 pt-3 bg-sidebar rounded-2xl border",children:[(0,i.jsx)(C.X,{files:N,sandboxId:g,onRemove:e=>{let t=N[e];t.localUrl&&URL.revokeObjectURL(t.localUrl),R(t=>t.filter((t,s)=>s!==e)),!g&&_.length>e&&E(t=>t.filter((t,s)=>s!==e))},layout:"inline",maxHeight:"216px",showPreviews:!0}),(0,i.jsx)(A,{ref:$,value:y,onChange:e=>{let t=e.target.value;j?h(t):w(t)},onSubmit:O,placeholder:a,loading:r,disabled:l,isAgentRunning:u,onStopAgent:m,isDraggingOver:k,uploadedFiles:N,fileInputRef:M,isUploading:S,sandboxId:g,setPendingFiles:E,setUploadedFiles:R,setIsUploading:G,hideAttachments:b,selectedModel:U,onModelChange:T,modelOptions:F,subscriptionStatus:q,canAccessModel:K})]})})}),u&&(0,i.jsx)(o.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"pb-4 -mt-4 w-full flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,i.jsx)(c.A,{className:"h-3 w-3 animate-spin"}),(0,i.jsx)("span",{children:"Kortix Suna is working..."})]})})]})});J.displayName="ChatInput"}}]);